# multi-party-lottery
เป็นงานที่เกี่ยวกับการทำล้อตตารี่ โดยมีทั้งหมด 4 สเตจ 

    * 1). การลงทะเบียน
    * 2). การเปิดค่า
    * 3). การคำณวนเเละเเบ่งเงิน คนสร้างคอนเเทคเท่านั้นที่จะทำได้
    * 4). การขอเงินคืนกรณที่ผิดผลาด

โดยได้เเบ่งการเก็บข้อมูลของผู้ใช้เป็น

    struct Player {
        address addr; 
        uint legalnumber; // บอกว่าข้อมูลนั้นอยุ่อันดับที่ถุกต้องที่เท่าไหร่
        uint choice; // 0 - 999
        uint commiting; // 1 เปิด 0 ปิด
        uint legal; // 1 ผิด 0 ผ่าน
    }

* โดยสเตจเเต่ละสเตจจะเปลี่ยนโดยมีเงื่อนไขด้านเวลา คือ เวลา T1 / T2 / T3 ตามลำดับ

โดยผู้เล่นจะต้องทำตามกฎในเวลาที่กำหนดไม่งั้นจะเสียสิทธิ์ในการชิงรางวัล โดยที่จะมีกฎดังนี้
  * ในสเตจที่ 1 ถ้าหากไม่ทำการ commit ในเวลา T1 หรือ ค่า commit มีค่าที่ มากกว่า 999 หรือ น้อยกว่า 0 จะถือว่าผิดกฎ
  * ในสเตจที่ 2 ถ้าหากไม่ทำการ reveal ค่าในเวลา T2 จะถูกสละสิทธิ์
  * ในสเตจที่ 3 / ถ้าหาก คนที่สรา้งคอนเเทคไม่ทำการ เเจกจ่ายเงินจะเข้าไปสเตจการคืนเงินที่สเตจ 4
      * โดยในกรณีที่ไม่มีใครทำตามกฎเลยสักคน คนสร้างคอนเเทคจะเป็นคนได้เงินไปทั้งหมด

โค้ดการคำณวน : เเจกจ่ายเงินเมื่อมีคนได้ 

      else {//กรณีที่มีคนได้
          
          //uint hash = uint(keccak256(abi.encodePacked(result)));
          //uint winnerNumber =  hash % legalPlayer  ;
          uint winnerNumber = result % legalPlayer ; // ไม่เเน่ใจว่าวิธีไหน
          //T1 = winnerNumber ;
        
          for(uint i = 0 ; i < N ; i++){
            if(player[i].legalnumber == winnerNumber){
                address payable chamAddr = payable(player[i].addr);
                chamAddr.transfer(coin * 98 / 100 );
                break ;
            }
          }
            
          contractOwner.transfer(coin * 2 / 100 ); //ส่วนเเบ่ง
          coin = 0;

        }

          for (uint i; i < numPlayer; i++) {
            player[i].legal = 2;
          }
        
    }

เเต่ไม่เเน่ใจว่าเราควรใช้ hash หรือไม่ใช่เพราะการที่ใช้ ค่า มันเป็น 0 ตลอดเลยไม่เเน่ใจ !

